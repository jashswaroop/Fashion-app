{% extends "modern_base.html" %}

{% block title %}Profile - Fashion Recommendation App{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold text-white mb-3">
            <i class="fas fa-user-circle text-primary"></i> My Profile
        </h1>
        <p class="text-muted">Customize your fashion preferences and personal information</p>
    </div>

    <div class="row g-5">
        <!-- Profile Form -->
        <div class="col-md-8">
            <div class="modern-card">
                <div class="d-flex align-items-center mb-4">
                    <i class="fas fa-edit text-primary fs-4 me-3"></i>
                    <h2 class="h4 fw-bold text-white mb-0">Profile Information</h2>
                </div>

                <form method="POST" class="needs-validation" novalidate>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="age" class="form-label">Age</label>
                            <input type="number" class="form-control" id="age" name="age" value="{{ user.age or '' }}" min="13" max="100" placeholder="Enter your age">
                        </div>

                        <div class="col-md-6">
                            <label for="gender" class="form-label">Gender</label>
                            <select class="form-select" id="gender" name="gender">
                                <option value="">Select Gender</option>
                                <option value="Female" {{ 'selected' if user.gender == 'Female' }}>Female</option>
                                <option value="Male" {{ 'selected' if user.gender == 'Male' }}>Male</option>
                                <option value="Non-binary" {{ 'selected' if user.gender == 'Non-binary' }}>Non-binary</option>
                                <option value="Prefer not to say" {{ 'selected' if user.gender == 'Prefer not to say' }}>Prefer not to say</option>
                            </select>
                        </div>
                    </div>

                    <div class="row g-3 mt-3">
                        <div class="col-md-6">
                            <label for="body_type" class="form-label">Body Type</label>
                            <select class="form-select" id="body_type" name="body_type">
                                <option value="">Select Body Type</option>
                                <option value="Pear" {{ 'selected' if user.body_type == 'Pear' }}>Pear</option>
                                <option value="Apple" {{ 'selected' if user.body_type == 'Apple' }}>Apple</option>
                                <option value="Hourglass" {{ 'selected' if user.body_type == 'Hourglass' }}>Hourglass</option>
                                <option value="Rectangle" {{ 'selected' if user.body_type == 'Rectangle' }}>Rectangle</option>
                                <option value="Inverted Triangle" {{ 'selected' if user.body_type == 'Inverted Triangle' }}>Inverted Triangle</option>
                            </select>
                        </div>

                        <div class="col-md-6">
                            <label for="style_preference" class="form-label">Style Preference</label>
                            <select class="form-select" id="style_preference" name="style_preference">
                                <option value="">Select Style</option>
                                <option value="Casual" {{ 'selected' if user.style_preference == 'Casual' }}>Casual</option>
                                <option value="Business" {{ 'selected' if user.style_preference == 'Business' }}>Business</option>
                                <option value="Formal" {{ 'selected' if user.style_preference == 'Formal' }}>Formal</option>
                                <option value="Bohemian" {{ 'selected' if user.style_preference == 'Bohemian' }}>Bohemian</option>
                                <option value="Minimalist" {{ 'selected' if user.style_preference == 'Minimalist' }}>Minimalist</option>
                                <option value="Trendy" {{ 'selected' if user.style_preference == 'Trendy' }}>Trendy</option>
                                <option value="Classic" {{ 'selected' if user.style_preference == 'Classic' }}>Classic</option>
                                <option value="Edgy" {{ 'selected' if user.style_preference == 'Edgy' }}>Edgy</option>
                            </select>
                        </div>
                    </div>

                    <div class="mt-4">
                        <label class="form-label">Color Preferences</label>
                        <div class="row">
                            <div class="col-6 col-sm-4 col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Black" id="color_black">
                                    <label class="form-check-label" for="color_black">Black</label>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="White" id="color_white">
                                    <label class="form-check-label" for="color_white">White</label>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Red" id="color_red">
                                    <label class="form-check-label" for="color_red">Red</label>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Blue" id="color_blue">
                                    <label class="form-check-label" for="color_blue">Blue</label>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Green" id="color_green">
                                    <label class="form-check-label" for="color_green">Green</label>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Pink" id="color_pink">
                                    <label class="form-check-label" for="color_pink">Pink</label>
                                </div>
                            </div>
                             <div class="col-6 col-sm-4 col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Purple" id="color_purple">
                                    <label class="form-check-label" for="color_purple">Purple</label>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Neutral" id="color_neutral">
                                    <label class="form-check-label" for="color_neutral">Neutral Tones</label>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" id="color_preference" name="color_preference" value="{{ user.color_preference or '' }}">
                    </div>

                    <div class="row g-3 mt-3">
                        <div class="col-md-6">
                            <label for="size_preference" class="form-label">Size</label>
                            <select class="form-select" id="size_preference" name="size_preference">
                                <option value="">Select Size</option>
                                <option value="XS" {{ 'selected' if user.size_preference == 'XS' }}>XS</option>
                                <option value="S" {{ 'selected' if user.size_preference == 'S' }}>S</option>
                                <option value="M" {{ 'selected' if user.size_preference == 'M' }}>M</option>
                                <option value="L" {{ 'selected' if user.size_preference == 'L' }}>L</option>
                                <option value="XL" {{ 'selected' if user.size_preference == 'XL' }}>XL</option>
                                <option value="XXL" {{ 'selected' if user.size_preference == 'XXL' }}>XXL</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="budget_range" class="form-label">Budget Range</label>
                            <select class="form-select" id="budget_range" name="budget_range">
                                <option value="">Select Budget</option>
                                <option value="Under $50" {{ 'selected' if user.budget_range == 'Under $50' }}>Under $50</option>
                                <option value="$50 - $100" {{ 'selected' if user.budget_range == '$50 - $100' }}>$50 - $100</option>
                                <option value="$100 - $200" {{ 'selected' if user.budget_range == '$100 - $200' }}>$100 - $200</option>
                                <option value="$200 - $500" {{ 'selected' if user.budget_range == '$200 - $500' }}>$200 - $500</option>
                                <option value="Over $500" {{ 'selected' if user.budget_range == 'Over $500' }}>Over $500</option>
                            </select>
                        </div>
                    </div>

                    <div class="d-flex gap-3 pt-4">
                        <button type="submit" class="btn btn-modern">
                            <i class="fas fa-save me-2"></i> Save Profile
                        </button>
                        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                            <i class="fas fa-arrow-left me-2"></i> Back to Dashboard
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Profile Tips Sidebar -->
        <div class="col-md-4">
            <div class="modern-card">
                <div class="d-flex align-items-center mb-4">
                    <i class="fas fa-lightbulb text-warning fs-4 me-3"></i>
                    <h3 class="h5 fw-bold text-white mb-0">Profile Tips</h3>
                </div>

                <div class="list-group list-group-flush">
                    <div class="list-group-item bg-transparent border-0 px-0">
                        <h4 class="h6 text-primary mb-2"><i class="fas fa-user-check me-2"></i> Complete Your Profile</h4>
                        <p class="small text-muted">The more information you provide, the better our AI can recommend clothing that matches your style and preferences.</p>
                    </div>
                     <div class="list-group-item bg-transparent border-0 px-0">
                        <h4 class="h6 text-primary mb-2"><i class="fas fa-palette me-2"></i> Color Analysis</h4>
                        <p class="small text-muted">Select colors that you feel confident wearing. Our AI will use this to suggest complementary colors.</p>
                    </div>
                    <div class="list-group-item bg-transparent border-0 px-0">
                        <h4 class="h6 text-primary mb-2"><i class="fas fa-ruler me-2"></i> Body Type</h4>
                        <p class="small text-muted">Knowing your body type helps us recommend clothing that flatters your figure.</p>
                    </div>
                    <div class="list-group-item bg-transparent border-0 px-0">
                        <h4 class="h6 text-primary mb-2"><i class="fas fa-magic me-2"></i> Style Preferences</h4>
                        <p class="small text-muted">Your style preference helps us curate recommendations that match your lifestyle and aesthetic.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Handle color preferences
    const colorCheckboxes = document.querySelectorAll('input[type="checkbox"][id^="color_"]');
    const colorPreferenceInput = document.getElementById('color_preference');
    
    // Load existing color preferences
    if (colorPreferenceInput.value) {
        const selectedColors = colorPreferenceInput.value.split(',');
        colorCheckboxes.forEach(checkbox => {
            if (selectedColors.includes(checkbox.value)) {
                checkbox.checked = true;
            }
        });
    }
    
    // Update color preferences when checkboxes change
    colorCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
            const selectedColors = Array.from(colorCheckboxes)
                .filter(cb => cb.checked)
                .map(cb => cb.value);
            colorPreferenceInput.value = selectedColors.join(',');
        });
    });
});
</script>
{% endblock %}
